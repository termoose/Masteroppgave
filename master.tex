\documentclass[a4paper,10pt]{amsart}
\usepackage{amsthm,mathrsfs}
\usepackage[all,cmtip]{xy}

%opening
\title{Counting points on elliptic curves}
\author{Ole Andre Birkedal}

\begin{document}
\newtheorem{thm}{Theorem}
\newtheorem{mydef}{Definition}
\newtheorem{ex}{Example}
\newtheorem{prop}{Proposition}
\newtheorem{lemma}{Lemma}

\begin{abstract}
hei hei
\end{abstract}

\maketitle
\tableofcontents

\include{alg_geometry}
\include{weil_tate}
\include{frobenius}
\include{schoof}


\section{Satoh's algorithm}
Forklaring og overblikk over de forskjellige subsection-ene.

This algorithm is divided into two parts, first we do what is called a \emph{lifting}, then
we recover the trace of the Frobenius from the lifted data.
\subsection{P-adic numbers}
Fixme
\subsection{Lifting the j-invariants}
We begin by establishing some notation, so let $\mathbb{F}_q$ be our finite field with $q=p^n$ as before,
$\mathbb{Z}_p$ the $p$-adic integers and $\mathbb{Q}_q$ the $q$-adic rationals as defined in section [ref].
For this section we let $\sigma$ be the $p$-th frobenius, and $\phi_q$ be the $q$-th frobenius.
As for previous sections we denote the curves over our finite fields as $E/\mathbb{F}_q$,
for the lifted curves we write $\mathscr{E}/\mathbb{Q}_q$.

\begin{thm}
 \textbf{(Lubin-Serre-Tate)} Let $E/\mathbb{F}_q$ be an elliptic curve with $j$-invariant $j(E)$ and
$\sigma$ the $p$-th Frobenius on $\mathbb{Q}_q$ then the system of equations
$$ \Phi_p(x, \sigma(x)) = 0 \quad x \equiv j(E) \, (mod\, p)$$
where $\Phi_p$ is the $p$-th modular polynomial has a unique solution $J \in \mathbb{Z}_q$ 
which is the $j$-invariant of the canonical lift $\mathscr{E}$ of $E$.
\end{thm}

Knowing $j(\mathscr{E})$ we can explicitly write out the Weierstrass equation for $\mathscr{E}$, but
instead of lifting $E$ to $\mathscr{E}$ directly we can consider all its conjugates
$$E, E^\sigma, E^{\sigma^2}, \ldots, E^{\sigma^{n-2}}, E^{\sigma^{n-1}} $$
Letting $E^{\sigma^i} = E^i $ we get a sequence of maps
$$ E \overset{\sigma}{\rightarrow} E^1 \overset{\sigma}{\rightarrow} E^2 \overset{\sigma}{\rightarrow}
\ldots \overset{\sigma}{\rightarrow} E^{n-1} $$
Where the composition is the $q$-th power Frobenius $\phi_q = \sigma \sigma \ldots \sigma: E \rightarrow E$.
Recall that the $deg(\sigma) = p$ so from the theory of modular polynomials we have that
$$ \Phi_p(j(E^i), j(E^{i+1})) = 0 $$

\begin{mydef}
 The \emph{canonical lift $\mathscr{E}$} of an elliptic curve $E$ over $\mathbb{F}_q$ is
an elliptic curve over $\mathbb{Q}_q$ such that $End(\mathscr{E}) \simeq End(E)$.
\end{mydef}

Since the endomorphism rings are isomorphic we can lift every Frobenius on $E$ to a
Frobenius on $\mathscr{E}$. We thus obtain a commutative diagram

$$
\xymatrix {
  \mathscr{E} \ar[d]^\pi \ar[r]^\sigma & \mathscr{E}^1 \ar[d]^\pi \ar[r]^\sigma & \ldots \ar[r]^\sigma & \mathscr{E}^{n-1} \ar[d]^\pi \ar[r]^\sigma & \mathscr{E} \ar[d]^\pi \\
  E \ar[r]^\sigma & E^1 \ar[r]^\sigma &\ldots \ar[r]^\sigma & E^{n-1} \ar[r]^\sigma & E \\
}
$$

Since the lifted Frobenius also has degree $p$ we have that
$$\Phi_p(j(\mathscr{E}^i), j(\mathscr{E}^{i+1})) = 0 \quad j(\mathscr{E}^i) \equiv j(\mathscr{E}^{i+1}) \, (mod\, p) $$
We thus define a function $\Theta: \mathbb{Z}_q^d \rightarrow \mathbb{Z}_q^d$ by
$$\Theta(x_0, x_1, \ldots, x_{n-1}) = (\Phi_p(x_0, x_1), \Phi_p(x_1, x_2), \ldots, \Phi_p(x_{n-1}, x_0))$$
Note that the roots of $\Theta$ are the $j$-invariants of our lifted curves
$$\Theta(j(\mathscr{E}), j(\mathscr{E}^2), \ldots, j(\mathscr{E}^{n-1})) = (0, 0, \ldots, 0) $$
so by solving $\Theta(\bar{x}) = 0$ using a multivariate Newton-Raphson iteration, we can
recover the $j$-invariants to desired precision. Setting up the Jacobian matrix $J_\Theta$
of $\Theta$, the iteration is given by
$$ \bar{x}_{n+1} = \bar{x}_n - J_\Theta^{-1} \Theta(\bar{x}_n) $$


$$
J_\Theta(x_0, x_1, \ldots, x_{n-1}) = 
\begin{pmatrix}
  {\partial \over \partial x_0} \Psi_p(x_0, x_1) & {\partial \over \partial x_1} \Psi_p(x_0, x_1) & 0 & \ldots & 0 & 0 \\
  0 & {\partial \over \partial x_1} \Psi_p(x_1, x_2) & {\partial \over \partial x_2} \Psi_p(x_1, x_2) & 0 & \ldots & 0 \\
  0 \\
  \vdots \\
  0 \\
  {\partial \over \partial x_0} \Psi_p(x_{n-1}, x_0) & 0 & \ldots & 0 & 0 & {\partial \over \partial x_{n-1}} \Psi_p(x_{n-1}, x_0) \\
\end{pmatrix}
$$

\subsection{Calculating coefficients}

\end{document}
